#
# Copyright (c) 2004 Specifix, Inc.
# All rights reserved
#

class tmpwatch(Recipe):
    description = """The tmpwatch utility recursively searches through specified
directories and removes files which have not been accessed in a
specified period of time. Tmpwatch is normally used to clean up
directories that are used for temporarily holding files (for example,
/tmp). Tmpwatch ignores symlinks, will not switch filesystems, and
only removes empty directories and regular files."""

    buildRequires = [ "glibc" ]
    runRequires = [ "cron" ]

    name = "tmpwatch"
    version = "2.9.0"

    def setup(self):
	self.macros['rpmrevision'] = "2.1"
	# The canonical URL is "ftp://ftp.redhat.com/pub/fedora/linux/core/development/SRPMS/tmpwatch-%(version)s-%(rpmrevision)s.src.rpm"
	# but it is always too busy, so we'll go to a well-known mirror instead
	self.addArchiveFromRPM("http://www.gtlib.cc.gatech.edu/pub/fedora.redhat/linux/core/development/SRPMS/tmpwatch-%(version)s-%(rpmrevision)s.src.rpm", 
	                      "tmpwatch-%(version)s.tar.gz")
	self.addSource("crond-tmpwatch")
	self.install = (
	    build.MakeInstall(rootVar = "ROOT"),
	    build.InstallFiles("crond-tmpwatch", 
			       "/etc/cron.daily/tmpwatch", 0755)
	)

    def package(self):
        self.setConfig('/etc/cron.daily/tmpwatch')
