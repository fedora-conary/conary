The transport code has been refactored into a different module, to simplify subclassing and robustness in flaky network scenarios.
